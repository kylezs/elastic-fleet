# Default values for kolide-fleet.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

replicaCount: 1

image:
  repository: kolide/fleet
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: "latest"

args:
  - "--config"
  - "/etc/fleet/config.yml"

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

podAnnotations:
  seccomp.security.alpha.kubernetes.io/pod: runtime/default

podSecurityContext:
  {}

securityContext:
  capabilities:
    # drop the default linux superuser capabilities
    drop:
    - ALL
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 1000

service:
  name: fleet-nodeport
  type: NodePort
  port: 8080

resources:
  {}

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 1
  targetCPUUtilizationPercentage: 80
  # targetMemoryUtilizationPercentage: 80

fleet:
  # to be handled by secrets
  auth:
    jwt_key: "jwt_key_cleartext"
  logging:
    debug: false
    json: true
    disable_banner: true
  server:
    tls: true
  filesystem:
    result_volume: /var/log/fleet

tls:
  generate: false

mysql:
  # This is required
  mysqlPassword: mysqlPasswordClearText
  mysqlDatabase: kolideClearText
  persistence:
    enabled: true
    existingClaim: kf-mysql-pvc

redis:
  cluster:
    slaveCount: 0
  master:
    persistence:
      enabled: false
  usePassword: false

elasticsearch:
  replicas: 1
  volumeClaimTemplate:
    accessModes: [ "ReadWriteOnce" ]
    resources:
      requests:
        # default is 30Gi
        storage: 10Gi
  podSecurityPolicy:
    name: "elasticsecuritypolicy"
    create: true
    spec:
      readOnlyRootFilesystem: true
      privileged: false
      allowPrivilegeEscalation: false
      hostPID: false
      hostNetwork: false
      volumes:
      - persistentVolumeClaim
      - configMap
      - secret


kibana:
  service:
    type: NodePort
    # Port the NodePort uses to access the service
    port: 5601
    # The port that the container exposes (default for kibana is 5601)
    targetPort: 5601
  securityContext:
    readOnlyRootFilesystem: true

